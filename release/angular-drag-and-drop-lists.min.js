var dndList;!function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return function(t){var n=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return function(e,t,n){n.prototype=e.prototype;var r=new n,o=e.apply(r,t);return"object"==typeof o?o:r}(t,e,function(){return null})};return n.$inject=e,n}}e.directive=t}(dndList||(dndList={}));var dndList;!function(e){var t=function(){function e(){}return e}();angular.module("dndLists",[]).service("dndService",t)}(dndList||(dndList={}));var __decorate=this&&this.__decorate||function(e,t,n,r){var o,d=arguments.length,i=d<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(d<3?o(i):d>3?o(t,n,i):o(t,n))||i);return d>3&&i&&Object.defineProperty(t,n,i),i},dndList;!function(e){var t=function(){function t(e,t,n){var r=this;this.$parse=e,this.$timeout=t,this.dndService=n,this.link=function(e,t,n){var o,d,i,a,l=r,c=0,s=0,g=0,p=0,v=!1,u=function(r){if("string"!=typeof r)m=r,interact(r).draggable({manualStart:!0}).on("move",function(r){if(!v&&!e.disabled){var u=r.interaction;if(u.pointerIsDown&&!u.interacting()){angular.element(document.body).addClass("dndDraggingBody"),v=!0;for(var f=t[0],h=f.querySelectorAll("[dnd-list]"),m=0;m<h.length;m++){var D=h[m];interact(D).dropzone(!1)}var S=f.getBoundingClientRect();c=S.left-r.clientX,s=S.top-r.clientY,g=0,p=0;var b=t[0].cloneNode(!0),y=angular.element(b);o=t.parent()[0],a=t.css("height"),i=t.css("width"),d=f.nextElementSibling,y.addClass("dndDragging"),y.css("width",S.width+"px"),y.css("height",S.height+"px"),document.body.appendChild(y[0]),S=f.getBoundingClientRect(),g+=r.clientX-S.left+c,p+=r.clientY-S.top+s,b.style.webkitTransform=b.style.transform="translate("+g+"px, "+p+"px)",l.dndService.draggingObject=e.$eval(n.dndDraggable),l.dndService.isDroped=!1,l.dndService.draggingElementScope=e,l.dndService.draggingElement=b,l.dndService.draggingSourceElement=t[0],l.$timeout(function(){l.$parse(n.dndDragstart)(e,{event:r})},0),interact(b).draggable({inertia:!0,autoScroll:!1}),r.interaction.start({name:"drag"},r.interactable,b),f.style.display="none"}}}).on("dragend",function(n){if(!e.disabled&&(n.interaction.stop(),n.target&&n.target.parentNode)){n.target.parentNode.removeChild(n.target);for(var r=t[0].querySelectorAll("[dnd-list]"),o=0;o<r.length;o++){var d=r[o];interact(d).dropzone(!0)}l.$timeout(function(){e.endDrag(n),t[0].style.display="block",angular.element(document.body).removeClass("dndDraggingBody")},0)}}).on("dragmove",function(t){if(!e.disabled){var n=t.target.getBoundingClientRect(),r=t.target;g+=t.clientX-n.left+c,p+=t.clientY-n.top+s,r.style.webkitTransform=r.style.transform="translate("+g+"px, "+p+"px)"}});else{r=t[0].querySelectorAll(r);for(var f=0;f<r.length;f++)u(r[f])}};n.ngDisabled&&(e.disabled=e.$eval(n.ngDisabled),e.$watch(n.ngDisabled,function(t,n){e.disabled=t,t?(D(),e.endDrag(null)):u(m)}));var f=function(t){e.disabled||n.dndSelected&&(e.$apply(function(){l.$parse(n.dndSelected)(e,{event:t})}),t.stopPropagation())},h=function(){t.off("click touchstart",f),t.on("click touchstart",f)};h();var m,D=function(){interact(m).draggable(!1)};if(e.endDrag=function(r){if(v)return v=!1,t.removeClass("dndDragging"),l.dndService.isDroped?l.$parse(n.dndMoved)(e,{event:r})?(l.$parse(n.dndDragend)(e,{event:r,isDroped:l.dndService.isDroped}),l.dndService.isDroped=!1,!0):(l.dndService.isDroped=!1,!1):(l.$parse(n.dndCanceled)(e,{event:r}),!1)},n.dndHandle){var S=e.$eval(n.dndHandle);u(S),e.$watch(n.dndHandle,function(e,t,n){D(),u(e)})}else u(t[0])}}return t=__decorate([e.directive("$parse","$timeout","dndService")],t)}();angular.module("dndLists").directive("dndDraggable",t)}(dndList||(dndList={}));var __decorate=this&&this.__decorate||function(e,t,n,r){var o,d=arguments.length,i=d<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(d<3?o(i):d>3?o(t,n,i):o(t,n))||i);return d>3&&i&&Object.defineProperty(t,n,i),i},dndList;!function(e){var t=function(){function t(e,t,n){var r=this;this.$parse=e,this.$timeout=t,this.dndService=n,this.link=function(e,t,n){var o=(n.dndHorizontalList&&e.$eval(n.dndHorizontalList),r.getPlaceholderElement(t)),d=o[0],i=t[0];o.remove();var a=r,l=0,c=0,s={},g=null;e.scroll={auto:!1},n.dndScroll&&(g=parseFloat(n.dndScroll),e.scroll={auto:!0,speed:g}),n.dndAccept&&(s.accept=n.dndAccept),interact(t[0]).dropzone(s).on("dragenter",function(t){r.stopScroll(e),e.disabled||(l=0,c=0,a.dndService.isDroped=!1)}).on("dragleave",function(n){return r.stopScroll(e),a.stopDragover(o,t)}).on("dropmove",function(l){if(e.disabled)return a.stopDragover(o,t);var c=angular.element(a.dndService.draggingElement);d.parentNode!=i&&t.append(o);var s,p=c.css("display");if(c.css("display","none"),s=document.elementFromPoint(l.dragEvent.clientX,l.dragEvent.clientY),c.css("display",p),s&&s!==i){for(var v=s;v.parentNode!==i&&v.parentNode;)v=v.parentNode;v.parentNode===i&&v!==d&&(a.isMouseInFirstHalf(l,v)?i.insertBefore(d,v):i.insertBefore(d,v.nextElementSibling))}if(n.dndDragover&&!a.invokeCallback(e,n.dndDragover,l,a.getPlaceholderIndex(i,d),a.dndService.draggingObject)&&a.stopDragover(o,t),g){var u=c[0].offsetHeight/2,f=i.getBoundingClientRect();l.dragEvent.clientY>=f.bottom-u&&l.dragEvent.clientY<=f.bottom+u?r.startScroll(e,i,1):l.dragEvent.clientY<=f.top+u&&l.dragEvent.clientY>=f.top-u?r.startScroll(e,i,-1):r.stopScroll(e)}t.addClass("dndDragover")}).on("drop",function(l){if(r.stopScroll(e),!a.dndService.isDroped){if(e.disabled)return a.stopDragover(o,t);var c=a.dndService.draggingObject;if(!c)return a.stopDragover(o,t);c=angular.copy(c),a.$timeout(function(){if(a.dndService.stopDrop)return a.dndService.isDroped=!1,a.dndService.draggingElementScope.endDrag(),a.stopDragover(o,t);var r=a.getPlaceholderIndex(i,d);if(r<0)return a.stopDragover(o,t);if(n.dndDragover&&!a.invokeCallback(e,n.dndDragover,l,r,c))return a.stopDragover(o,t);if(n.dndBeforeDrop){var s=a.invokeCallback(e,n.dndBeforeDrop,l,r,c);if(!s)return a.dndService.isDroped=!1,a.dndService.draggingElementScope.endDrag(l),a.stopDragover(o,t)}return a.dndService.isDroped=!0,a.dndService.draggingElementScope.endDrag(l)?(r=a.getPlaceholderIndexWithoutNode(i,d,a.dndService.draggingSourceElement),n.dndDrop&&(c=a.invokeCallback(e,n.dndDrop,l,r,c)),c!==!0&&e.$eval(n.dndList).splice(r,0,c),a.invokeCallback(e,n.dndInserted,l,r,c),void a.stopDragover(o,t)):a.stopDragover(o,t)},0)}}),n.ngDisabled&&(e.disabled=e.$eval(n.ngDisabled),e.disabled&&interact(t[0]).dropzone(!1),e.$watch(n.ngDisabled,function(n,r){e.disabled=n,n?interact(t[0]).dropzone(!1):interact(t[0]).dropzone(!0)}))}}return t.prototype.isMouseInFirstHalf=function(e,t,n){void 0===n&&(n=!1);var r=e.dragEvent,o=n?r.clientX:r.clientY,d=t.getBoundingClientRect(),i=n?d.width:d.height,a=n?d.left:d.top;return o<a+i/2},t.prototype.startScroll=function(e,t,n){void 0===n&&(n=-1),this.stopScroll(e),this.performScroll(e,t,n)},t.prototype.performScroll=function(e,t,n){var r=this;if(void 0===n&&(n=-1),e.scroll.auto){var o=0;1==n?(o=e.scroll.speed,t.scrollTop+o+t.offsetHeight>t.scrollHeight&&(o=t.scrollHeight-t.scrollTop-t.offsetHeight),o<0&&(o=0)):n==-1&&(o=-e.scroll.speed,t.scrollTop+o<0&&(o=-t.scrollTop)),t.scrollTop+=o,e.scroll.timer=setTimeout(function(){r.performScroll(e,t,n)},20)}},t.prototype.stopScroll=function(e){e.scroll.timer&&(clearTimeout(e.scroll.timer),e.scroll.timer=null)},t.prototype.stopDragover=function(e,t){return e.remove(),t.removeClass("dndDragover"),!0},t.prototype.getPlaceholderIndex=function(e,t){return Array.prototype.indexOf.call(e.children,t)},t.prototype.getPlaceholderIndexWithoutNode=function(e,t,n){for(var r=0,o=0;o<e.children.length;o++,r++){if(e.children[o]==t)return r;e.children[o]==n&&r--}return r},t.prototype.invokeCallback=function(e,t,n,r,o){return void 0===o&&(o=null),this.$parse(t)(e,{event:n,index:r,item:o||void 0})},t.prototype.getPlaceholderElement=function(e){var t;return angular.forEach(e.children(),function(e){var n=angular.element(e);n.hasClass("dndPlaceholder")&&(t=n)}),t||angular.element("<li class='dndPlaceholder'></li>")},t=__decorate([e.directive("$parse","$timeout","dndService")],t)}();angular.module("dndLists").directive("dndList",t)}(dndList||(dndList={}));